<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Compare Decoy Populations &#8212; rstoolbox 1.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/functions.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Generation of New Variants" href="new_mutants.html" />
    <link rel="prev" title="Working with Fragments" href="working_with_fragments.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          rstoolbox</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../scripts.html">Scripts</a></li>
                <li><a href="../tutorial.html">Tutorial</a></li>
                <li><a href="../api.html">API</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">An introduction to rstoolbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../highlights.html">Highlighted works</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Installing and Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts.html">Available direct executables</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorial.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rosettascripts.html">RosettaScripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew.html">What’s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Compare Decoy Populations</a><ul>
<li><a class="reference internal" href="#merging-populations">Merging Populations</a><ul>
<li><a class="reference internal" href="#the-two-populations-should-share-column-names">The two populations should share column names</a></li>
<li><a class="reference internal" href="#there-must-be-a-column-to-identify-to-which-population-each-decoy-belongs">There must be a column to identify to which population each decoy belongs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#comparing-basic-scores">Comparing Basic Scores</a></li>
<li><a class="reference internal" href="#sequence-distances">Sequence Distances</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="compare-decoy-populations">
<span id="population-comparison"></span><h1>Compare Decoy Populations<a class="headerlink" href="#compare-decoy-populations" title="Permalink to this headline">¶</a></h1>
<p>Comparing features between populations is one of the best ways to benchmark different conditions in an experiment.</p>
<p>This example works over two populations designed in the same manner, with the only difference that one was performed in the presence of a binder while the other
was design alone.</p>
<blockquote>
<div>We are ignoring some scores to facilitate general reading, but this particularity is not mentioned any more during the tutorial. Similarly, we are using only a sample of the 20K
available sequences on each decoy population.</div></blockquote>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">rstoolbox</span> <span class="kn">as</span> <span class="nn">rs</span>
<span class="gp">   ...: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="gp">   ...: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">   ...: </span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.width&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_seq_items&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">binder</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">parse_rosetta_file</span><span class="p">(</span><span class="s1">&#39;../rstoolbox/tests/data/compare/binder.mini.gz&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sequence&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;scores_ignore&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;fa_*&#39;</span><span class="p">,</span> <span class="s1">&#39;dslf_fa13&#39;</span><span class="p">,</span> <span class="s1">&#39;yhh_planarity&#39;</span><span class="p">,</span> <span class="s1">&#39;pro_close&#39;</span><span class="p">]})</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">binder</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
<span class="gp">   ...: </span>
<span class="gh">Out[1]: </span><span class="go"></span>
<span class="go">array([&#39;score&#39;, &#39;hbond_sr_bb&#39;, &#39;hbond_lr_bb&#39;, &#39;hbond_bb_sc&#39;, &#39;hbond_sc&#39;,</span>
<span class="go">       &#39;rama&#39;, &#39;omega&#39;, &#39;p_aa_pp&#39;, &#39;ref&#39;, &#39;BUNS&#39;, &#39;B_ni_mtcontacts&#39;,</span>
<span class="go">       &#39;B_ni_rmsd&#39;, &#39;B_ni_rmsd_threshold&#39;, &#39;B_ni_trials&#39;, &#39;GRMSD2Target&#39;,</span>
<span class="go">       &#39;GRMSD2Template&#39;, &#39;LRMSD2Target&#39;, &#39;LRMSDH2Target&#39;,</span>
<span class="go">       &#39;LRMSDLH2Target&#39;, &#39;cav_vol&#39;, &#39;design_score&#39;, &#39;packstat&#39;,</span>
<span class="go">       &#39;rmsd_drift&#39;, &#39;description&#39;, &#39;sequence_B&#39;], dtype=object)</span>

<span class="gp">In [2]: </span><span class="n">nobinder</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">parse_rosetta_file</span><span class="p">(</span><span class="s1">&#39;../rstoolbox/tests/data/compare/nobinder.mini.gz&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sequence&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;scores_ignore&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;fa_*&#39;</span><span class="p">,</span> <span class="s1">&#39;dslf_fa13&#39;</span><span class="p">,</span> <span class="s1">&#39;yhh_planarity&#39;</span><span class="p">,</span> <span class="s1">&#39;pro_close&#39;</span><span class="p">]})</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">nobinder</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
<span class="gp">   ...: </span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                            Out[2]: </span>
<span class="go">array([&#39;score&#39;, &#39;hbond_sr_bb&#39;, &#39;hbond_lr_bb&#39;, &#39;hbond_bb_sc&#39;, &#39;hbond_sc&#39;,</span>
<span class="go">       &#39;rama&#39;, &#39;omega&#39;, &#39;p_aa_pp&#39;, &#39;ref&#39;, &#39;BUNS&#39;, &#39;B_ni_mtcontacts&#39;,</span>
<span class="go">       &#39;B_ni_rmsd&#39;, &#39;B_ni_rmsd_threshold&#39;, &#39;B_ni_trials&#39;, &#39;GRMSD2Target&#39;,</span>
<span class="go">       &#39;GRMSD2Template&#39;, &#39;LRMSD2Target&#39;, &#39;LRMSDH2Target&#39;,</span>
<span class="go">       &#39;LRMSDLH2Target&#39;, &#39;cav_vol&#39;, &#39;design_score&#39;, &#39;packstat&#39;,</span>
<span class="go">       &#39;rmsd_drift&#39;, &#39;description&#39;, &#39;sequence_B&#39;], dtype=object)</span>
</pre></div>
</div>
<div class="section" id="merging-populations">
<h2>Merging Populations<a class="headerlink" href="#merging-populations" title="Permalink to this headline">¶</a></h2>
<p>Merging populations is a very useful way to a take advantage of the plotting and analysis tools compatible with <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.24.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a> derived objects. In order
for it to be useful and possible, two conditions must meet:</p>
<div class="section" id="the-two-populations-should-share-column-names">
<h3>The two populations should share column names<a class="headerlink" href="#the-two-populations-should-share-column-names" title="Permalink to this headline">¶</a></h3>
<p>Not all, but sure for those that are expected to be analysed comparatively. When they all come from a same experiment, that is relatively easy to obtain in the setup. otherwise, one can use the rename option to fix that.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [3]: </span><span class="n">binder</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;score&#39;</span><span class="p">:</span> <span class="s1">&#39;renamed_score&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
<span class="gh">Out[3]: </span><span class="go"></span>
<span class="go">array([&#39;renamed_score&#39;, &#39;hbond_sr_bb&#39;, &#39;hbond_lr_bb&#39;, &#39;hbond_bb_sc&#39;,</span>
<span class="go">       &#39;hbond_sc&#39;, &#39;rama&#39;, &#39;omega&#39;, &#39;p_aa_pp&#39;, &#39;ref&#39;, &#39;BUNS&#39;,</span>
<span class="go">       &#39;B_ni_mtcontacts&#39;, &#39;B_ni_rmsd&#39;, &#39;B_ni_rmsd_threshold&#39;,</span>
<span class="go">       &#39;B_ni_trials&#39;, &#39;GRMSD2Target&#39;, &#39;GRMSD2Template&#39;, &#39;LRMSD2Target&#39;,</span>
<span class="go">       &#39;LRMSDH2Target&#39;, &#39;LRMSDLH2Target&#39;, &#39;cav_vol&#39;, &#39;design_score&#39;,</span>
<span class="go">       &#39;packstat&#39;, &#39;rmsd_drift&#39;, &#39;description&#39;, &#39;sequence_B&#39;],</span>
<span class="go">      dtype=object)</span>
</pre></div>
</div>
</div>
<div class="section" id="there-must-be-a-column-to-identify-to-which-population-each-decoy-belongs">
<h3>There must be a column to identify to which population each decoy belongs<a class="headerlink" href="#there-must-be-a-column-to-identify-to-which-population-each-decoy-belongs" title="Permalink to this headline">¶</a></h3>
<p>In this example, none exist. But if we take a look at the naming of the decoys:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;{0} &lt;-&gt; {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">binder</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;description&#39;</span><span class="p">],</span> <span class="n">nobinder</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;description&#39;</span><span class="p">]))</span>
<span class="go">classicFFL_FFL_binder_motif_DesignRelax_noaa_pack_13636_3lhp_0196 &lt;-&gt; classicFFL_FFL_nobinder_motif_DesignRelax_noaa_30229_3lhp_0002</span>
</pre></div>
</div>
<p>We could see that, by loading the data not with the <a class="reference internal" href="readrosetta.html#readrosetta"><span class="std std-ref">definition</span></a> <code class="docutils literal notranslate"><span class="pre">{'sequence':</span> <span class="pre">'B'}</span></code> but with <code class="docutils literal notranslate"><span class="pre">{'sequence':</span> <span class="pre">'B',</span> <span class="pre">'naming':</span> <span class="pre">['',</span> <span class="pre">'',</span> <span class="pre">'condition']}</span></code> we would
have automatically obtained a column <code class="docutils literal notranslate"><span class="pre">condition</span></code> defining the binder presence.
As we did not do that, or in case that would not be possible, we will just add an extra column.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="n">binder</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">binder</span><span class="p">,</span> <span class="s1">&#39;condition&#39;</span><span class="p">,</span> <span class="s1">&#39;binder&#39;</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">binder</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
<span class="gp">   ...: </span>
<span class="gh">Out[5]: </span><span class="go"></span>
<span class="go">array([&#39;score&#39;, &#39;hbond_sr_bb&#39;, &#39;hbond_lr_bb&#39;, &#39;hbond_bb_sc&#39;, &#39;hbond_sc&#39;,</span>
<span class="go">       &#39;rama&#39;, &#39;omega&#39;, &#39;p_aa_pp&#39;, &#39;ref&#39;, &#39;BUNS&#39;, &#39;B_ni_mtcontacts&#39;,</span>
<span class="go">       &#39;B_ni_rmsd&#39;, &#39;B_ni_rmsd_threshold&#39;, &#39;B_ni_trials&#39;, &#39;GRMSD2Target&#39;,</span>
<span class="go">       &#39;GRMSD2Template&#39;, &#39;LRMSD2Target&#39;, &#39;LRMSDH2Target&#39;,</span>
<span class="go">       &#39;LRMSDLH2Target&#39;, &#39;cav_vol&#39;, &#39;design_score&#39;, &#39;packstat&#39;,</span>
<span class="go">       &#39;rmsd_drift&#39;, &#39;description&#39;, &#39;sequence_B&#39;, &#39;condition&#39;],</span>
<span class="go">      dtype=object)</span>

<span class="gp">In [6]: </span><span class="n">nobinder</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">nobinder</span><span class="p">,</span> <span class="s1">&#39;condition&#39;</span><span class="p">,</span> <span class="s1">&#39;nobinder&#39;</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">nobinder</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
<span class="gp">   ...: </span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                               Out[6]: </span>
<span class="go">array([&#39;score&#39;, &#39;hbond_sr_bb&#39;, &#39;hbond_lr_bb&#39;, &#39;hbond_bb_sc&#39;, &#39;hbond_sc&#39;,</span>
<span class="go">       &#39;rama&#39;, &#39;omega&#39;, &#39;p_aa_pp&#39;, &#39;ref&#39;, &#39;BUNS&#39;, &#39;B_ni_mtcontacts&#39;,</span>
<span class="go">       &#39;B_ni_rmsd&#39;, &#39;B_ni_rmsd_threshold&#39;, &#39;B_ni_trials&#39;, &#39;GRMSD2Target&#39;,</span>
<span class="go">       &#39;GRMSD2Template&#39;, &#39;LRMSD2Target&#39;, &#39;LRMSDH2Target&#39;,</span>
<span class="go">       &#39;LRMSDLH2Target&#39;, &#39;cav_vol&#39;, &#39;design_score&#39;, &#39;packstat&#39;,</span>
<span class="go">       &#39;rmsd_drift&#39;, &#39;description&#39;, &#39;sequence_B&#39;, &#39;condition&#39;],</span>
<span class="go">      dtype=object)</span>
</pre></div>
</div>
<p>Once all conditions are met, the populations can be merged:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">binder</span><span class="p">,</span> <span class="n">nobinder</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="comparing-basic-scores">
<h2>Comparing Basic Scores<a class="headerlink" href="#comparing-basic-scores" title="Permalink to this headline">¶</a></h2>
<p>The first and most straight forward analysis between populations is the comparison between their different scores distributions. For that,
<a class="reference internal" href="../generated/rstoolbox.plot.multiple_distributions.html#rstoolbox.plot.multiple_distributions" title="rstoolbox.plot.multiple_distributions"><code class="xref py py-func docutils literal notranslate"><span class="pre">multiple_distributions()</span></code></a> accepts any attribute of <a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.boxplot.html#seaborn.boxplot" title="(in seaborn v0.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">boxplot()</span></code></a>, so that data can be properly separated.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="gp">   ...: </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
<span class="gp">   ...: </span><span class="n">fig</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="gp">   ...: </span><span class="n">grid</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="gp">   ...: </span><span class="n">axes</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">multiple_distributions</span><span class="p">(</span> <span class="n">df</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;condition&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;condition&#39;</span><span class="p">,</span> <span class="n">showfliers</span><span class="o">=</span><span class="bp">False</span> <span class="p">)</span>
<span class="gp">   ...: </span><span class="n">nones</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">]</span>
<span class="gp">   ...: </span><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="gp">   ...: </span>

<span class="gp">In [9]: </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/tutorial_duo_plt1.png"><img alt="../_images/tutorial_duo_plt1.png" src="../_images/tutorial_duo_plt1.png" style="width: 10in;" /></a>
<p>The data can even be directly used on <code class="xref py py-mod docutils literal notranslate"><span class="pre">seaborn</span></code> functions:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [10]: </span><span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="n">_</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;design_score&#39;</span><span class="p">,</span> <span class="s1">&#39;GRMSD2Target&#39;</span><span class="p">,</span> <span class="s1">&#39;GRMSD2Template&#39;</span><span class="p">,</span> <span class="s1">&#39;LRMSD2Target&#39;</span><span class="p">,</span> <span class="s1">&#39;LRMSDH2Target&#39;</span><span class="p">,</span> <span class="s1">&#39;LRMSDLH2Target&#39;</span><span class="p">,</span> <span class="s1">&#39;condition&#39;</span><span class="p">]],</span>
<span class="gp">   ....: </span>                 <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;condition&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [11]: </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/tutorial_duo_plt2.png"><img alt="../_images/tutorial_duo_plt2.png" src="../_images/tutorial_duo_plt2.png" style="width: 10in;" /></a>
<p>More specific comparisons can be performed depending on the actual aim of the project.</p>
</div>
<div class="section" id="sequence-distances">
<h2>Sequence Distances<a class="headerlink" href="#sequence-distances" title="Permalink to this headline">¶</a></h2>
<p>Let’s assume that one wants to evaluate the spread of the two populations and how well they recover a given target reference sequence. For that,
we will need to provide a reference sequence.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="n">reference</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">get_sequence_and_structure</span><span class="p">(</span><span class="s1">&#39;../rstoolbox/tests/data/compare/4oyd.pdb&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sequence&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">})</span>
<span class="gp">   ....: </span><span class="n">_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">add_reference_sequence</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">reference</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_sequence</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<p>A tutorial for <a class="reference internal" href="sequence_analysis.html#sequence-analysis"><span class="std std-ref">population sequence analysis</span></a> is also available, but there are options that can be used when comparing two populations.</p>
<p>For instance, one can evaluate the internal sequence inside each decoy population and then compare it between the two:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [13]: </span><span class="n">disbinder</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;condition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;binder&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sequence_distance</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="n">disbinder</span> <span class="o">=</span> <span class="n">disbinder</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">disbinder</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)))</span> <span class="c1"># mask diagonal and upper diagonal values</span>
<span class="gp">   ....: </span><span class="n">disbinder</span> <span class="o">=</span> <span class="n">disbinder</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="c1"># to array</span>
<span class="gp">   ....: </span><span class="n">disbinder</span> <span class="o">=</span> <span class="n">disbinder</span><span class="p">[[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">disbinder</span><span class="p">)]]</span> <span class="c1"># clean NaN</span>
<span class="gp">   ....: </span>
<span class="gp">   ....: </span><span class="n">disnobinder</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;condition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nobinder&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sequence_distance</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="n">disnobinder</span> <span class="o">=</span> <span class="n">disnobinder</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">disnobinder</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)))</span> <span class="c1"># mask diagonal and upper diagonal values</span>
<span class="gp">   ....: </span><span class="n">disnobinder</span> <span class="o">=</span> <span class="n">disnobinder</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="c1"># to array</span>
<span class="gp">   ....: </span><span class="n">disnobinder</span> <span class="o">=</span> <span class="n">disnobinder</span><span class="p">[[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">disnobinder</span><span class="p">)]]</span> <span class="c1"># clean NaN</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<p>Or evaluate the distance between the two sequence populations:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [14]: </span><span class="n">discomp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;condition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;binder&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sequence_distance</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;condition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nobinder&#39;</span><span class="p">])</span>
<span class="gp">   ....: </span><span class="n">discomp</span> <span class="o">=</span> <span class="n">discomp</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="c1"># to array</span>
<span class="gp">   ....: </span><span class="n">discomp</span> <span class="o">=</span> <span class="n">discomp</span><span class="p">[[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">discomp</span><span class="p">)]]</span> <span class="c1"># clean NaN</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<p>Or the distance of each group to the reference sequence:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [15]: </span><span class="n">disbinderref</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">sequence_similarity</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;condition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;binder&#39;</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">matrix</span><span class="o">=</span><span class="s1">&#39;IDENTITY&#39;</span><span class="p">)[</span><span class="s1">&#39;identity_B_negative&#39;</span><span class="p">]</span>
<span class="gp">   ....: </span><span class="n">disnobinderref</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">sequence_similarity</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;condition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nobinder&#39;</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">matrix</span><span class="o">=</span><span class="s1">&#39;IDENTITY&#39;</span><span class="p">)[</span><span class="s1">&#39;identity_B_negative&#39;</span><span class="p">]</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<p>We can show all this together as:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [16]: </span><span class="n">fig</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">   ....: </span><span class="n">grid</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">   ....: </span><span class="n">ax00</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">   ....: </span><span class="n">_</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span> <span class="n">disbinder</span> <span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;binder&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax00</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="n">_</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span> <span class="n">disnobinder</span> <span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;nobinder&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax00</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="n">rs</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">add_top_title</span><span class="p">(</span><span class="n">ax00</span><span class="p">,</span> <span class="s1">&#39;internal distance&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="n">ax01</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">   ....: </span><span class="n">_</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span> <span class="n">discomp</span> <span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;binder vs. nobinder&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax01</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="n">rs</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">add_top_title</span><span class="p">(</span><span class="n">ax01</span><span class="p">,</span> <span class="s1">&#39;comparative distance&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="n">ax02</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">   ....: </span><span class="n">_</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span> <span class="n">disbinderref</span> <span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;binder&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax02</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="n">_</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span> <span class="n">disnobinderref</span> <span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;nobinder&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax02</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="n">rs</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">add_top_title</span><span class="p">(</span><span class="n">ax02</span><span class="p">,</span> <span class="s1">&#39;distance to reference&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="gp">   ....: </span>

<span class="gp">In [17]: </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/tutorial_duo_plt3.png"><img alt="../_images/tutorial_duo_plt3.png" src="../_images/tutorial_duo_plt3.png" style="width: 10in;" /></a>
<p>To fully asses the difference between the two populations, we can evaluate the enrichment of different residue types in different positions. In
this scenario, we will measure the enrichment of variants in the binder-designed population against the other. This entails that high values
represent residue types more present in the binder-design population per position.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [18]: </span><span class="n">result</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">positional_enrichment</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;condition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;binder&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;condition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nobinder&#39;</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>When a position is represented in the first population but not in the second, the enrichment is <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/constants.html#numpy.inf" title="(in NumPy v1.16)"><code class="xref py py-data docutils literal notranslate"><span class="pre">inf</span></code></a>. To visualize it,
one would need to transform it into a numerical value. In this case, we transform it into a value such as <code class="docutils literal notranslate"><span class="pre">max</span> <span class="pre">+</span> <span class="pre">(max/2)</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [19]: </span><span class="n">maxval</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gp">   ....: </span><span class="n">maxval</span> <span class="o">+=</span> <span class="p">(</span><span class="n">maxval</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">   ....: </span><span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">maxval</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">   ....: </span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">   ....: </span><span class="n">rs</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">sequence_frequency_plot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">xrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [20]: </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/tutorial_duo_plt4.png"><img alt="../_images/tutorial_duo_plt4.png" src="../_images/tutorial_duo_plt4.png" style="width: 10in;" /></a>
<p>Comparing enrichment between the populations (i.e. full sequence enrichment) is demonstrated in the <a class="reference internal" href="experimental_analysis.html#experimental-analysis"><span class="std std-ref">experimental analysis tutorial</span></a>.</p>
</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2018, Jaume Bonet.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.<br/>
    </p>
  </div>
</footer>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-74877325-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-74877325-2');
</script>

  </body>
</html>