<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Contextualize your Data &#8212; rstoolbox 0.9.0 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/functions.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="What’s new" href="../whatsnew.html" />
    <link rel="prev" title="Experimental Data" href="experimental_analysis.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          rstoolbox</a>
        <span class="navbar-text navbar-version pull-left"><b>0.9.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../scripts.html">Scripts</a></li>
                <li><a href="../tutorial.html">Tutorial</a></li>
                <li><a href="../api.html">API</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">An introduction to rstoolbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../highlights.html">Highlighted works</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Installing and Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts.html">Available direct executables</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorial.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rosettascripts.html">RosettaScripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew.html">What’s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Contextualize your Data</a><ul>
<li><a class="reference internal" href="#pre-calculated-datasets">Pre-calculated datasets</a></li>
<li><a class="reference internal" href="#cleaning-your-own-background-sets">Cleaning your own background sets</a></li>
<li><a class="reference internal" href="#distribution-in-context">Distribution in context</a></li>
<li><a class="reference internal" href="#selections-in-context">Selections in context</a></li>
<li><a class="reference internal" href="#each-selection-in-its-context">Each selection in its context</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="contextualize-your-data">
<span id="contextualize"></span><h1>Contextualize your Data<a class="headerlink" href="#contextualize-your-data" title="Permalink to this headline">¶</a></h1>
<p>The generation of a new design population can provide a lot of data depending in the number of filters and metrics used to evaluate
them. Still, although these scores allow for the sorting and selection of decoys of interest, it does not always provide a
comprehensive analysis of that population with regard to the general population of known protein structures.</p>
<p>The <strong>rstoolbox</strong> provides some helper functions and datasets in order to properly assess this issue.</p>
<div class="section" id="pre-calculated-datasets">
<h2>Pre-calculated datasets<a class="headerlink" href="#pre-calculated-datasets" title="Permalink to this headline">¶</a></h2>
<p>There is a total of 4 different pre-calculated datasets that can be loaded directly with the <strong>rstoolbox</strong>; those are <code class="docutils literal notranslate"><span class="pre">cath</span></code>, <code class="docutils literal notranslate"><span class="pre">scop</span></code>,
<code class="docutils literal notranslate"><span class="pre">scop2</span></code> and <code class="docutils literal notranslate"><span class="pre">chain</span></code> (for PDB chains). For this datasets, homology (as provided by the PDB database) can be used to avoid over-represented
structures. The access to these datasets is provided through the <a class="reference internal" href="../generated/rstoolbox.utils.load_refdata.html#rstoolbox.utils.load_refdata" title="rstoolbox.utils.load_refdata"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_refdata()</span></code></a> function:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">rstoolbox</span> <span class="kn">as</span> <span class="nn">rs</span>
<span class="gp">   ...: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="gp">   ...: </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="gp">   ...: </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
<span class="gp">   ...: </span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;svg.fonttype&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span> <span class="c1"># When plt.savefig to &#39;svg&#39;, text is still text object</span>
<span class="gp">   ...: </span><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.width&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">scop2</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_refdata</span><span class="p">(</span><span class="s1">&#39;scop2&#39;</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">scop2_70</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_refdata</span><span class="p">(</span><span class="s1">&#39;scop2&#39;</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span>  <span class="c1"># 70% homology filter</span>
<span class="gp">   ...: </span><span class="n">scop2_70</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sequence_$&#39;</span><span class="p">,</span> <span class="s1">&#39;structure_$&#39;</span><span class="p">,</span> <span class="s1">&#39;psi_$&#39;</span><span class="p">,</span> <span class="s1">&#39;phi_$&#39;</span><span class="p">,</span> <span class="s1">&#39;node_name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">   ...: </span>
<span class="gh">Out[1]: </span><span class="go"></span>
<span class="go">   scop_id  serial   pdb chain  begin  end   selectors  leaf      domain_id    score  hbond_sr_bb  hbond_lr_bb  hbond_bb_sc  hbond_sc  dslf_fa13   omega  p_aa_pp  yhh_planarity      ref  rama_prepro  BUNS  CYDentropy  avdegree  beta  breaks   cavity  charge  exposed_hyd  helix  long_apolar  long_polar   pack  psipred  radius  length                                        node_id</span>
<span class="go">0  8003767  1       2UWE  I     1      99   (I:1-99,)   True  2UWEI80037671 -237.172 -8.136       -42.638      -17.730      -7.007    -1.163      9.673  -23.884   0.026          8.637   -8.386        2.0   7.735       10.010    6.0   0.0     10.279  -2.0     932.371      0.0    6.0          6.0         0.661  0.727    14.066  99      [2000051, 6001103, 5000763, 4000202, 3000071]</span>
<span class="go">1  8003798  1       2OAN  C     4      371  (C:4-371,)  True  2OANC80037981 -898.795 -139.883     -78.118      -37.999      -39.343    0.000      33.758 -72.597   0.036          121.341  2.231        31.0  0.000       11.330    13.0  1.0     294.330 -12.0    2812.701     15.0   7.0          6.0         0.657  0.675    21.333  357     [3000092, 6001267, 5000898, 4000313]         </span>
<span class="go">2  8003706  1       2UUB  M     2      125  (M:2-125,)  True  2UUBM80037061 -74.236  -56.345      -4.286       -7.571       -5.800     0.000      6.343  -22.039   0.001          43.878   10.694       17.0  0.000       9.516     0.0   0.0     41.054   19.0    1472.719     6.0    6.0          8.0         0.631  0.758    21.976  124     [6001039, 5000712, 4000260]                  </span>
<span class="go">3  8017549  1       1FQB  A     2      370  (A:2-370,)  True  1FQBA80175491 -957.723 -144.574     -69.207      -53.420      -29.550    0.000      15.504 -71.976   0.045          83.748   4.174        42.0  0.000       11.715    12.0  0.0     432.225 -9.0     2157.583     16.0   8.0          5.0         0.671  0.702    21.546  369     [6002815, 5001965]                           </span>
<span class="go">4  8004502  1       1W8M  A     2      164  (A:2-164,)  True  1W8MA80045021 -461.079 -36.431      -56.442      -37.828      -15.055    0.000      17.157 -58.100   0.004          57.392  -3.910        17.0  0.000       11.294    8.0   0.0     38.591   2.0     1157.008     2.0    7.0          10.0        0.786  0.687    14.256  163     [6001369, 5000991, 4000390, 3000168, 2000164]</span>
</pre></div>
</div>
<p>These sets are only provided as help, but the user can create its own sets, as long as they are loaded as a <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.23.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a>.</p>
</div>
<div class="section" id="cleaning-your-own-background-sets">
<h2>Cleaning your own background sets<a class="headerlink" href="#cleaning-your-own-background-sets" title="Permalink to this headline">¶</a></h2>
<p>In case one has its own background reference dataset, <strong>rstoolbox</strong> offers the option to retrieve homology clusters precalculated
from PDB with the <a class="reference internal" href="../generated/rstoolbox.utils.make_redundancy_table.html#rstoolbox.utils.make_redundancy_table" title="rstoolbox.utils.make_redundancy_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_redundancy_table()</span></code></a> function. By default, this function will call on the PDB’s ftp to download those
homology cluster files, but with <code class="docutils literal notranslate"><span class="pre">precalculated==True</span></code> it will directly provide a quicker access to the table available in the
library (as the first option is relatively time consuming).</p>
<p>The generated table can be used on your reference set as long as a <code class="docutils literal notranslate"><span class="pre">pdb</span></code> and <code class="docutils literal notranslate"><span class="pre">chain</span></code> column exists.</p>
<p>The following example shows now this table can be applied in what would be the equivalent of <code class="docutils literal notranslate"><span class="pre">rs.utils.load_refdata('scop2',</span> <span class="pre">30)</span></code>
and creates a visual representation of the clusters.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [2]: </span><span class="n">hmdf</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">make_redundancy_table</span><span class="p">(</span><span class="n">precalculated</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">scop2_30</span> <span class="o">=</span> <span class="n">scop2</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">hmdf</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdb&#39;</span><span class="p">,</span> <span class="s1">&#39;chain&#39;</span><span class="p">])</span>
<span class="gp">   ...: </span><span class="n">scop2_30</span> <span class="o">=</span> <span class="n">scop2_30</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;c30&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="gp">   ...: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="gp">   ...: </span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">_</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">hmdf</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdb&#39;</span><span class="p">,</span> <span class="s1">&#39;chain&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;c30&#39;</span><span class="p">,</span> <span class="s1">&#39;c40&#39;</span><span class="p">,</span> <span class="s1">&#39;c50&#39;</span><span class="p">,</span> <span class="s1">&#39;c70&#39;</span><span class="p">,</span> <span class="s1">&#39;c90&#39;</span><span class="p">,</span> <span class="s1">&#39;c95&#39;</span><span class="p">,</span> <span class="s1">&#39;c100&#39;</span><span class="p">]),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">   ...: </span>

<span class="gp">In [3]: </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/tutorial_ctx_plt1.png"><img alt="../_images/tutorial_ctx_plt1.png" src="../_images/tutorial_ctx_plt1.png" style="width: 10in;" /></a>
</div>
<div class="section" id="distribution-in-context">
<h2>Distribution in context<a class="headerlink" href="#distribution-in-context" title="Permalink to this headline">¶</a></h2>
<p>Let’s assume the following population dataset:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="n">rules</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;scores_ignore&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;fa_*&#39;</span><span class="p">,</span> <span class="s1">&#39;niccd_*&#39;</span><span class="p">,</span> <span class="s1">&#39;hbond_*&#39;</span><span class="p">,</span> <span class="s1">&#39;lk_ball_wtd&#39;</span><span class="p">,</span> <span class="s1">&#39;pro_close&#39;</span><span class="p">,</span> <span class="s1">&#39;dslf_fa13&#39;</span><span class="p">,</span> <span class="s1">&#39;C_ni_rmsd_threshold&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>                           <span class="s1">&#39;omega&#39;</span><span class="p">,</span> <span class="s1">&#39;p_aa_pp&#39;</span><span class="p">,</span> <span class="s1">&#39;yhh_planarity&#39;</span><span class="p">,</span> <span class="s1">&#39;ref&#39;</span><span class="p">,</span> <span class="s1">&#39;rama_prepro&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">],</span>
<span class="gp">   ...: </span>         <span class="s1">&#39;sequence&#39;</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>         <span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;MOTIF&#39;</span><span class="p">,</span> <span class="s1">&#39;SSE03&#39;</span><span class="p">,</span> <span class="s1">&#39;SSE05&#39;</span><span class="p">]}</span>
<span class="gp">   ...: </span><span class="n">df</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">parse_rosetta_file</span><span class="p">(</span><span class="s1">&#39;../rstoolbox/tests/data/input_ssebig.minisilent.gz&#39;</span><span class="p">,</span> <span class="n">rules</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">   ...: </span>
<span class="gh">Out[4]: </span><span class="go"></span>
<span class="go">    score  ALIGNRMSD  BUNS  COMPRRMSD  C_ni_mtcontacts  C_ni_rmsd  C_ni_trials  MOTIFRMSD  cav_vol  driftRMSD  finalRMSD  packstat C_ni_rmsd_type                            description lbl_MOTIF lbl_SSE03 lbl_SSE05                                                  sequence_C</span>
<span class="go">0 -64.070  0.608      12.0  7.585      4.0              3.301      1.0          0.957      66.602   0.083      3.323      0.544     no_motif       nubinitio_wauto_18326_2pw9C_0001_0001  [C]       [C]       [C]       TTWIKFFAGGTLVEEFEYSSVNWEEIEKRAWKKLGRWKKAEEGDLMIVYPDGKVVSWA</span>
<span class="go">1 -70.981  0.639      12.0  2.410      8.0              1.423      1.0          0.737      0.000    0.094      1.395      0.552     no_motif       nubinitio_wauto_18326_2pw9C_0002_0001  [C]       [C]       [C]       NTWSTNILNGHPKITLLVEERGAEEIHLEWLKKQGLRKKAEENVYTTKLPNGAVKVYG</span>
<span class="go">2 -43.863  0.480      8.0   4.279      6.0              2.110      1.0          0.819      93.641   0.110      2.106      0.575     no_motif       nubinitio_wauto_18326_2pw9C_0003_0001  [C]       [C]       [C]       PRWFIAMGDGVIWEIVLGSEQNLEEIAKKGLKRRGLYKKAEESIYTIIYPDGIAHTFG</span>
</pre></div>
</div>
<p>As previously demonstrated in the <a class="reference internal" href="sequence_analysis.html#sequence-analysis"><span class="std std-ref">sequence analysis</span></a> tutorial, we can preview the distribution of different
scores of the design population:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="n">fig</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">   ...: </span><span class="n">grid</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="gp">   ...: </span><span class="n">axes</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">multiple_distributions</span><span class="p">(</span> <span class="n">df</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">grid</span> <span class="p">)</span>
<span class="gp">   ...: </span><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="gp">   ...: </span>

<span class="gp">In [6]: </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/tutorial_ctx_plt2.png"><img alt="../_images/tutorial_ctx_plt2.png" src="../_images/tutorial_ctx_plt2.png" style="width: 10in;" /></a>
<p>But we can also see the population behave against other protein of a similar size.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The function will pick up that columns with the same name are the same, for others that should be the same but are called
differently, a translation dictionary can be provided, as is the case in this example with <code class="docutils literal notranslate"><span class="pre">cavity</span> <span class="pre">volume</span></code> and <code class="docutils literal notranslate"><span class="pre">packstat</span></code>
data.</p>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="n">slength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_sequence</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">))</span>
<span class="gp">   ...: </span><span class="n">refdf</span> <span class="o">=</span> <span class="n">scop2</span><span class="p">[(</span><span class="n">scop2</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">slength</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span>
<span class="gp">   ...: </span>              <span class="p">(</span><span class="n">scop2</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">slength</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span>
<span class="gp">   ...: </span>              <span class="p">(</span><span class="n">scop2</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">)]</span>
<span class="gp">   ...: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">   ...: </span><span class="n">axs</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">multiple_distributions</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">refdata</span><span class="o">=</span><span class="n">refdf</span><span class="p">,</span> <span class="n">violins</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="gp">   ...: </span>                                     <span class="n">ref_equivalences</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cavity&#39;</span><span class="p">:</span> <span class="s1">&#39;cav_vol&#39;</span><span class="p">,</span> <span class="s1">&#39;pack&#39;</span><span class="p">:</span> <span class="s1">&#39;packstat&#39;</span><span class="p">})</span>
<span class="gp">   ...: </span><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="gp">   ...: </span>

<span class="gp">In [8]: </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/tutorial_ctx_plt3.png"><img alt="../_images/tutorial_ctx_plt3.png" src="../_images/tutorial_ctx_plt3.png" style="width: 10in;" /></a>
</div>
<div class="section" id="selections-in-context">
<h2>Selections in context<a class="headerlink" href="#selections-in-context" title="Permalink to this headline">¶</a></h2>
<p>Contrary to the previous example, in which full distributions where compared, another useful tool is the ability to place selected
structures in a given context. This can have two main uses: <strong>(1)</strong> see the position of selected decoys in a given distribution
or <strong>(2)</strong> see the quality of putative template scaffolds before working with them.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [9]: </span><span class="n">pickdf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">   ...: </span><span class="n">axs</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">plot_in_context</span><span class="p">(</span><span class="n">pickdf</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">refdata</span><span class="o">=</span><span class="n">refdf</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="s1">&#39;packstat&#39;</span><span class="p">,</span> <span class="s1">&#39;cav_vol&#39;</span><span class="p">,</span> <span class="s1">&#39;BUNS&#39;</span><span class="p">],</span>
<span class="gp">   ...: </span>                              <span class="n">ref_equivalences</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cavity&#39;</span><span class="p">:</span> <span class="s1">&#39;cav_vol&#39;</span><span class="p">,</span> <span class="s1">&#39;pack&#39;</span><span class="p">:</span> <span class="s1">&#39;packstat&#39;</span><span class="p">})</span>
<span class="gp">   ...: </span><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="gp">   ...: </span>

<span class="gp">In [10]: </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/tutorial_ctx_plt4.png"><img alt="../_images/tutorial_ctx_plt4.png" src="../_images/tutorial_ctx_plt4.png" style="width: 10in;" /></a>
</div>
<div class="section" id="each-selection-in-its-context">
<h2>Each selection in its context<a class="headerlink" href="#each-selection-in-its-context" title="Permalink to this headline">¶</a></h2>
<p>Multiple selected decoys or scaffolds originated from different sources might not be all comparable under the same set. The most
simple case would be when those structures do not have a similar length, which does affect <strong>Rosetta</strong> scores.
In those scenarios, it is possible to see, for each decoy of interest, how well it compares to its reference dataset, and rank
them according to which quantile of the distribution they belong to:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_refdata</span><span class="p">(</span><span class="s1">&#39;scop&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="n">qr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s1">&#39;2F4V&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;3BFU&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;2APJ&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="p">[</span><span class="s1">&#39;2C37&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;2I6E&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdb&#39;</span><span class="p">,</span> <span class="s1">&#39;chain&#39;</span><span class="p">])</span>
<span class="gp">   ....: </span><span class="n">qr</span> <span class="o">=</span> <span class="n">qr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdb&#39;</span><span class="p">,</span> <span class="s1">&#39;chain&#39;</span><span class="p">])</span>
<span class="gp">   ....: </span><span class="n">refs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">   ....: </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">qr</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
<span class="gp">   ....: </span>  <span class="n">refs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">5</span><span class="p">))</span> <span class="o">&amp;</span>
<span class="gp">   ....: </span>                 <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">5</span><span class="p">))])</span>
<span class="gp">   ....: </span><span class="n">fig</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="gp">   ....: </span><span class="n">rs</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">distribution_quality</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">qr</span><span class="p">,</span> <span class="n">refdata</span><span class="o">=</span><span class="n">refs</span><span class="p">,</span>
<span class="gp">   ....: </span>                             <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="s1">&#39;pack&#39;</span><span class="p">,</span> <span class="s1">&#39;avdegree&#39;</span><span class="p">,</span> <span class="s1">&#39;cavity&#39;</span><span class="p">,</span> <span class="s1">&#39;psipred&#39;</span><span class="p">],</span>
<span class="gp">   ....: </span>                             <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">],</span>
<span class="gp">   ....: </span>                             <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;domain_id&#39;</span><span class="p">],</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="gp">   ....: </span>

<span class="gp">In [12]: </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/tutorial_ctx_plt5.png"><img alt="../_images/tutorial_ctx_plt5.png" src="../_images/tutorial_ctx_plt5.png" style="width: 10in;" /></a>
</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2018, Jaume Bonet.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.<br/>
    </p>
  </div>
</footer>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-74877325-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-74877325-2');
</script>

  </body>
</html>